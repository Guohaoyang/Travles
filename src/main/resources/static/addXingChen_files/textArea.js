define(["css!web_old_textarea"],function(){function t(t,e){for(var i=[],a=e;a<t.length;a++)i.push(t[a]);return i}function e(t){this.$obj=t.$obj,this.timer=null,this.option=t.option,this.init()}var i=jQuery;e.prototype={$obj:null,$textarea:null,$cloneTextarea:null,initHeight:null,maxHeight:null,timer:null,option:null,init:function(){this.$textarea=this.$obj.find("textarea").size()?this.$obj.find("textarea"):this.$obj.find("input"),this.$obj.attr("data-width")&&(this.$textarea.css("width",this.$obj.attr("data-width")),this.initHeight=this.$obj.attr("data-height")||this.$textarea.outerHeight()),this.$obj.attr("data-height")&&(this.$textarea.css("height",this.$obj.attr("data-height")),this.initWidth=this.$obj.attr("data-width")||this.$textarea.outerWidth()),this.option&&this.option.autoIncreaseHeight===!0&&(this.$cloneTextarea=this.createClone(this.$textarea)),this.$obj.show(),this.updateUI(),this.bindEvent()},createClone:function(t){if(t){var e=this.$textarea.clone(!0);return e.removeAttr("placeholder").css({position:"absolute",left:"-9999em",overflow:"auto"}),e.insertAfter(t),e}},bindEvent:function(){var t=this;this.$obj.keyup(function(e){t.registEvent()})},registEvent:function(){var t=this;window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){t.updateUI(!0)},100)},updateUI:function(t){var e=this.$textarea,a=this.$cloneTextarea,n=this.$obj.find(".max"),r=this.$obj.find(".min"),h=this.$obj.find(".current"),o=(this.$obj.find(".exceed"),this.option.max),s=this.option.min,l=e.val().length;if(a){var u,d;a[0].value=e.val(),u=parseInt(a[0].scrollHeight,10),d=i.isNumeric(this.$obj.attr("data-max-height"))?this.$obj.attr("data-max-height"):99999,u>this.initHeight?(e.addClass("autoHeight"),u>=d&&(u=d,e.removeClass("autoHeight"))):u=this.initHeight,e.css("height",u),u=d=null}-1==o?s>l?(h.addClass("red"),0==l&&h.removeClass("red")):h.removeClass("red"):s>l||l>o?(h.addClass("red"),0==l&&h.removeClass("red")):h.removeClass("red"),h.html(l),n.html(o),r.html(s),$aTextArea=a=n=h=$left=o=s=l=left=null},isValidate:function(){var t=this.$obj.find("textarea").val().length;return-1==this.option.max?t>=this.option.min:t>=this.option.min&&t<=this.option.max},getContent:function(){return this.$obj.find("textarea")[0]},setValue:function(t){this.$textarea.val(t),this.$cloneTextarea.val(t),this.updateUI(!0)},getTextArea:function(){return this.$obj.find("textarea")[0]},unload:function(){this.$cloneTextarea.remove()},reset:function(){this.$textarea.val(""),this.$cloneTextarea.val(""),this.$obj.find(".current").html(0)}},i.fn.extend({qyerTextArea:function(a){var n,r;if(n={isValidate:function(t){return t.data("_qyerTextArea").isValidate()},getValue:function(t){return t.data("_qyerTextArea").getTextArea().value},unload:function(t){t.data("_qyerTextArea").unload()},reset:function(t){t.data("_qyerTextArea").setValue("")},setValue:function(t,e){t.data("_qyerTextArea").setValue(e)}},r=i.type(a),"object"==r||"undefined"==r)i.each(this,function(t,n){var r,h;r=i(n),h=i.extend({},a),h.max="undefined"!=typeof h.max?h.max:-1,h.min="undefined"!=typeof h.min?h.min:0,h.width=1==i.isNumeric(r.attr("data-width"))?r.attr("data-width"):null,h.height=1==i.isNumeric(r.attr("data-height"))?r.attr("data-height"):null,r.data("_qyerTextArea")||r.data("_qyerTextArea",new e({$obj:r,option:h})),r=h=null});else if("string"==r){var h,o,s=[];if(o=arguments,i.each(this,function(e,r){if(h=i(r),n[a]){var l=t(o,1);l.unshift(h),s.push(n[a].apply(h,l)),l=null}}),h=o=null,s.length)return 1==s.length?s[0]:s}return n=r=null,this}})});