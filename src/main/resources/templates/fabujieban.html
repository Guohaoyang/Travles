<!DOCTYPE html>
<!-- saved from url=(0038)http://www.iqingyi.com/company/addinfo -->
<html lang="zh-CN" class="translated-ltr" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="renderer" content="webkit">
    <meta name="apple-itunes-app" content="app-id=1070845754">
    <meta name="keywords" content="">
    <meta name="description" content="">
        <link rel="bookmark" type="image/x-icon" href="http://www.iqingyi.com/static/common/favicon.ico">
    <link rel="shortcut icon" href="http://www.iqingyi.com/static/common/favicon.ico" type="image/x-icon">
	<title>发布结伴</title>
	 <link rel="stylesheet" href="../static/layui/css/layui.css"  media="all">
            <link rel="stylesheet" id="layuicss-laydate" href="../static/fabujieban_files/pc.css" charset="UTF-8">
	<!--[if lt IE 9]>
    <link rel="stylesheet" href="/static/css/pc/hack.css"/>
    <![endif]-->
<style>
.autocomplete{background:#fff;border:1px solid #efefef;list-style-type:none;}
.autocomplete li{height:20px;line-height:20px;border-bottom:1px solid #efefef;cursor:default;}
.highlight {background-color: #9ACCFB;}
#registerCity{outline:none;width:100%;}
 </style>
<script src="../static/fabujieban_files/hm.js.下载"></script><script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?c9daf1fcaa8b272daec2d5c78cd8f207";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
<style type="text/css">.fancybox-margin{margin-right:17px;}</style><link type="text/css" rel="stylesheet" charset="UTF-8" href="../static/fabujieban_files/translateelement.css"></head>
<body>
	<noscript>
		<style>
			html {display: block;}
		</style>
	</noscript>
	<!-- header start -->
	 <input type="hidden" name="uname" id="uname"  th:value="${list.uname}"/>
	 <input type="hidden" name="uid" id="uid"   th:value="${list.uid}"/>
	 <div class="navbar navbar-default navbar-fixed-top g-header">
		<div style="background-color: black;" class="navbar-inner">
			<div class="container">
                <a href="../myself/querycity" class="logo" title="青驿旅游"><img src="../static/fabujb_files/logo.png" width="60" height="40" alt="青驿旅游"></a>
				<div class="nav-logined clearfix">
					<ul class="nav navbar-nav header-nav" > 
						<li id="navOfIndex"><a href="/" title="青驿">首页</a></li>
						<li id="headerNav"><a href="/explore" title="发现">发现</a></li>
					</ul>
					<div class="navbar-form pull-left" id="navbarForm">
						<div  class="header-search-bar" id="searchBar">
							<input type="text" autocomplete="off" placeholder="搜索 地名/用户" class="typeahead form-control">
							<button class="btn-seach" title="点击搜索" type="button"></button>
						</div>
						<ul class="dropdown-menu search-prompt" role="menu">
							<li class="search-type type-scenic">地名</li>
							<li class="search-type type-user">用户</li>
				        </ul>
					</div>
					<ul class="nav navbar-nav header-nav">
						<li id="qaIndex"><a href="/qa_square" title="问答">问答</a></li>
						<li id="companyIndex"><a href="cs" title="结伴">结伴</a></li>
						<li><a href="/scenics" title="旅行地">旅行地</a></li>
						<li style="margin-left: 40px;"><a href="../strategy/a" title="攻略">攻略</a></li>
					</ul>
					<ul class="nav navbar-nav pull-right  header-nav" id="userInfo"> 
						<li class="dropdown" th:if="${list!=null}">
							<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown"><span class="user-name" th:text="${list.uname}"></span><span class="caret"></span></a>
							<ul style="color: black;" class="dropdown-menu g-dropdown-menu" role="menu">
								<li><span class="arrow-top"></span>
								<li class="clearfix"><a  class="clearfix" th:title="${list.uname}" target="_blank" href=""><img class="photo-sm" th:src="${list.upic}"></a>
					            <li><a  href="javascrpit:;" title="个人设置">个人设置</a>
					            <li><a  href="javascrpit:;" title="退出" id="loginOut">退出</a>
					        </ul>
					        </li>
							<div th:if="${list==null}">
								<li class="dropdown">
									<a href="../user/a" class="header-login" rel="nofollow">登录/注册</a>
								</li>
							</div>
					</ul> 
				</div>
			</div>
		</div>
	</div>	
<div class="container clearfix" id="center">
    <!-- g-main start -->
    <div class="g-main mt25">
        <div class="main-content">
           <h3 class="title" style="font-size: 18px;padding: 0 0 15px 0;border-bottom: 1px solid #eee"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发布结伴</font></font></h3>
            	<div class="form-group">
                    <label for="title">标题：<span>（可以输入40个字）</span></label>
                    <div class="input-box clearfix">
                        <input type="text" style="width: 80%" class="form-control pull-left" name="title" id="title" placeholder="简要概括结伴需求">
                    </div>
                </div>
                <div class="form-group">
                    <label for="endScenic">旅行地：</label>
                    <div class="scenic-box hidden clearfix" id="destinationBox"></div>
                    <div class="input-box clearfix">
                        <input type="text" style="width: 29.3%" class="form-control destination-key pull-left" name="ccid" id="search_text" placeholder="输入旅行地">
                    </div>
                    <div id="auto_div" ></div>
                </div>
                <div class="layui-form-item">
				    <div class="layui-inline">
				     <label for="endScenic">旅游起始日：</label>
				      <div class="layui-input-block">
				        <input type="text" name="createtime" id="date1" autocomplete="off" style="width:100px;position: absolute;left:-110px; " class="layui-input">
				      </div>
				    </div>
				    <div class="layui-inline">
				     <label for="endScenic">旅游结束日：</label>
				      <div class="layui-input-block">
				        <input type="text" name="endtime" id="date" autocomplete="off" style="width:100px;position: absolute;left:-110px; " class="layui-input">
				      </div>
				    </div>
			    </div>
			    <div class="form-group tip-left-11">
                    <label for="peopleNum">我方出发人数：<span>（不能超过50个人）</span></label>
                    <div class="input-box clearfix">
                        <input type="text" class="form-control pull-left" style="width: 10%" id="num" value="1">
                    </div>
                </div>
			    <div class="form-group">
                    <label for="endScenic">出发地：</label>
                    <div class="scenic-box hidden clearfix" id="destinationBox"></div>
                    <div class="input-box clearfix">
                        <input type="text" name="cid" style="width: 29.3%" class="form-control destination-key pull-left" id="search_text2" placeholder="请输入出发的省份或国家">
                    </div>
                    <div id="auto_div2" ></div>
                </div>
                <div class="form-group clearfix">
                    <label for="description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结伴详情：</font></font></label><span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（不超过600个字）</font></font></span>
                    <textarea class="form-control" rows="5" name="cscontent" id="cscontent" placeholder="如果你不想：
					1、结伴无人问津；
					2、旅游遇到猪队友；
					3、和每个人都沟通相同的问题；
					那就在这里多说点吧！"></textarea>
                </div>
                <div class="form-group">
                    <label for="contact"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">封面图：</font></font><span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（自拍照、景点照均可，吸引更多目光。）</font></font></span></label>
                    <div class="cover-box clearfix">
                         <img  class="layui-upload-img" style="width:150px;height: 150px" id="img_driver">
                         <progress id="progressBar"  value="0" max="100" style="width: 300px;"></progress>
							<span id="percentage"></span><span id="time"></span>
							<br /><br />
							<input type="file" id="input_upload_driver"  name="photo" accept="image/jpg, image/png, image/jpeg"  onChange="preview(this,'img_driver');" />
							<input type="button" class="layui-btn layui-btn-danger" onclick="UpladFile()" value="上传" />		
                    </div>
                </div>
                
                <div class="form-group pt20 clearfix">
                    <p class="pull-left" style="line-height: 39px;color: #222">
                        发布后，青驿将第一时间开启结伴引擎，每日24小时不停为你查找合适的人。有结果后会实时向你发送通知。
                    </p>
                    <input type="button" class="layui-btn layui-btn-fluid" value="发布" onclick="aa()">
                </div>
             
        </div>
    </div>
    <script>var _qy_pushid_="547547496977532214";</script>
<script src="/static/pc/app-build/qymain.js?v=201801024"></script><script merge="layuicss-laydate" src="/static/pc/app-build/qy-d-company-add.js?v=201801206"></script>
<!-- footer start -->
	<div class="container footer">
		<div class="copyright">
            <a href="/sitemap" target="_blank">网站地图</a>
            <a href="/app" target="_blank">青驿App</a>
            <a href="/about/faq" target="_blank" rel="nofollow">常见问题</a>
            <a href="/about/founders_words" target="_blank">关于青驿</a>
            <a href="/about/contact_us" target="_blank" rel="nofollow">联系我们</a>
			© 2015 iQingyi.com
			<a href="http://www.miitbeian.gov.cn/" target="_blank" rel="nofollow">粤ICP备15028558号</a>
		</div>
	</div>
    <!-- g-main end -->
    <!-- right sidebar end -->
</div>
<!-- js引用文件 -->
<script>var _qy_pushid_="547547496977532214";</script>
<script src="../static/fabujieban_files/qymain.js.下载"></script><a href="javascript:void(0)" class="m-gotop" title="回到顶部" style="right: 389.5px; display: none; bottom: 10px;" id="goTop"></a><script merge="layuicss-laydate" src="../static/fabujieban_files/qy-d-company-add.js.下载"></script>
<!-- footer start -->
	<!-- footer end -->
<!-- pop window user info wrp -->
<div id="popInfo" class="m-pop-info-wrp"></div>
<script src="../static/js/jquery-1.8.3.min.js" type="text/javascript"></script>
</body>
	<!-- 搜索智能提示下拉框 -->
    <script type="text/javascript">
        //测试用的数据，这里可以用AJAX获取服务器数据
        var test_list;
         $.ajax({
        	url:"queryByCity",
  			type:'post',
  			datatype:'json',
  			success:function(data){
  				console.log(data);
  				test_list=data;
  			}
        }); 
        var old_value = "";
        var highlightindex = -1;   //高亮
        //自动完成
        function AutoComplete(auto, search, mylist) {
            if ($("#" + search).val() != old_value || old_value == "") {
                var autoNode = $("#" + auto);   //缓存对象（弹出框）
                var carlist = new Array();
                var n = 0;
                old_value = $("#" + search).val();
                for (i in mylist) {
                    if (mylist[i].indexOf(old_value) >= 0) {
                        carlist[n++] = mylist[i];
                    }
                }
                if (carlist.length == 0) {
                    autoNode.hide();
                    return;
                }
                autoNode.empty();  //清空上次的记录
                for (i in carlist) {
                    var wordNode = carlist[i];   //弹出框里的每一条内容
                    var newDivNode = $("<div>").attr("id", i);    //设置每个节点的id值
                    newDivNode.attr("style", "font:14px/25px arial;height:25px;padding:0 8px;cursor: pointer;");
                    newDivNode.html(wordNode).appendTo(autoNode);  //追加到弹出框
                    //鼠标移入高亮，移开不高亮
                    newDivNode.mouseover(function () {
                        if (highlightindex != -1) {        //原来高亮的节点要取消高亮（是-1就不需要了）
                            autoNode.children("div").eq(highlightindex).css("background-color", "white");
                        }
                        //记录新的高亮节点索引
                        highlightindex = $(this).attr("id");
                        $(this).css("background-color", "#ebebeb");
                    });
                    newDivNode.mouseout(function () {
                        $(this).css("background-color", "white");
                    });
                    //鼠标点击文字上屏
                    newDivNode.click(function () {
                        //取出高亮节点的文本内容
                        var comText = autoNode.hide().children("div").eq(highlightindex).text();
                        highlightindex = -1;
                        //文本框中的内容变成高亮节点的内容
                        $("#" + search).val(comText);
                    })
                    if (carlist.length > 0) {    //如果返回值有内容就显示出来
                        autoNode.show();
                    } else {               //服务器端无内容返回 那么隐藏弹出框
                        autoNode.hide();
                        //弹出框隐藏的同时，高亮节点索引值也变成-1
                        highlightindex = -1;
                    }
                }
            }
            //点击页面隐藏自动补全提示框
            document.onclick = function (e) {
                var e = e ? e : window.event;
                var tar = e.srcElement || e.target;
                if (tar.id != search) {
                    if ($("#" + auto).is(":visible")) {
                        $("#" + auto).css("display", "none");
                    }
                }
            }
        }
        $(window).on('load',function(){
            old_value = $("#search_text").val();
            /* $("#search_text").focus(function () {
                if ($("#search_text").val() == "") {
                    AutoComplete("auto_div", "search_text", test_list);
                }
            }); */
           
            	$("#search_text").keyup(function () {
            		var a= $("#search_text").val().length;
                    if(a>0){
                    	AutoComplete("auto_div", "search_text", test_list);
                    }else{
                    	var c=document.getElementById("auto_div");
                    	c.style.display='none';
                    }
            	});
                $("#search_text2").keyup(function () {
                	var a= $("#search_text2").val().length;
                    if(a>0){
                    	AutoComplete("auto_div2", "search_text2", test_list);
                    }else{
                    	var c=document.getElementById("auto_div2");
                    	c.style.display='none';
                    }
                });
            
        });
    </script>
    <script src="../static/layui/layui.js" charset="utf-8"></script>
   <!-- 日期layui -->
    <script>
		layui.use(['form', 'layedit', 'laydate'], function(){
		  var form = layui.form
		  ,layer = layui.layer
		  ,layedit = layui.layedit
		  ,laydate = layui.laydate;
		  
		  //日期
		  laydate.render({
		    elem: '#date'
		    	,min: 0
			    ,max: 31
		  });
		  laydate.render({
		    elem: '#date1'
		    	,min: 0
			    ,max: 31
		  });
		});
	</script>
	<!-- 预览文件 -->
	<script type="text/javascript">
	/**
	 * 缩略图预览
	 * @param file
	 * @param container
	 */
	var preview = function(file, container){
	    //缩略图类定义
	    var Picture  = function(file, container){
	        var height = 0,
	            width  = 0,
	            ext    = '',
	            size   = 0,
	            name   = '',
	            path   =  '';
	        var self   = this;
	        if(file){
	            name = file.value;
	            if(window.navigator.userAgent.indexOf("MSIE")>=1){
	                file.select();
	                path = document.selection.createRange().text;
	            }else {
	                if(file.files){
	                    // path =  file.files.item(0).getAsDataURL(); // firefox7.0之后该方法弃用了，用下面那个
	                    path = window.URL.createObjectURL(file.files[0]);
	                }else{
	                    path = file.value;
	                }
	            }
	        }else{
	            throw '无效的文件';
	        }
	        ext = name.substr(name.lastIndexOf("."), name.length);
	        if(container.tagName.toLowerCase() != 'img'){
	            throw '不是一个有效的图片容器';
	            container.visibility = 'hidden';
	        }
	        container.src = path;
	        container.alt = name;
	        container.style.visibility = 'visible';
	        height = container.height;
	        width  = container.width;
	        size   = container.fileSize;
	        this.get = function(name){
	            return self[name];
	        };
	        this.isValid = function(){
	            if(allowExt.indexOf(self.ext) !== -1){
	                throw '不允许上传该文件类型';
	                return false;
	            }
	        }
	    };

	    try{
	        var pic =  new Picture(file, document.getElementById('' + container));
	    }catch(e){
	        alert(e);
	    }
	};
	</script>
	<!-- 上传文件 -->
<script type="text/javascript">
    //图片上传
    var xhr;
    //上传文件方法
    function UpladFile() {
        var fileObj = document.getElementById("input_upload_driver").files[0]; // js 获取文件对象
        var url =  "sc"; // 接收上传文件的后台地址

        var form = new FormData(); // FormData 对象
        form.append("photo", fileObj); // 文件对象
        xhr = new XMLHttpRequest();  // XMLHttpRequest 对象
        xhr.open("post", url, true); //post方式，url为服务器请求地址，true 该参数规定请求是否异步处理。
        xhr.onload = uploadComplete; //请求完成
        xhr.onerror =  uploadFailed; //请求失败
        xhr.upload.onprogress = progressFunction;//【上传进度调用方法实现】
        xhr.upload.onloadstart = function(){//上传开始执行方法
            ot = new Date().getTime();   //设置上传开始时间
            oloaded = 0;//设置上传开始时，以上传的文件大小为0
        };
        xhr.send(form); //开始上传，发送form数据
    }
    //上传成功响应
    function uploadComplete(evt) {
        //服务断接收完文件返回的结果
        alert(evt);
        var data = JSON.parse(evt.target.responseText);
        if(data.success) {
            alert("上传成功！");
        }else{
            alert("上传失败！");
        }
    }
    //上传失败
    function uploadFailed(evt) {
        alert("上传失败！");
    }
    //取消上传
    function cancleUploadFile(){
        xhr.abort();
    }
    //上传进度实现方法，上传过程中会频繁调用该方法
    function progressFunction(evt) {
        var progressBar = document.getElementById("progressBar");
        var percentageDiv = document.getElementById("percentage");
        // event.total是需要传输的总字节，event.loaded是已经传输的字节。如果event.lengthComputable不为真，则event.total等于0
        if (evt.lengthComputable) {//
            progressBar.max = evt.total;
            progressBar.value = evt.loaded;
            percentageDiv.innerHTML = Math.round(evt.loaded / evt.total * 100) + "%";
        }
        var time = document.getElementById("time");
        var nt = new Date().getTime();//获取当前时间
        var pertime = (nt-ot)/1000; //计算出上次调用该方法时到现在的时间差，单位为s
        ot = new Date().getTime(); //重新赋值时间，用于下次计算
        var perload = evt.loaded - oloaded; //计算该分段上传的文件大小，单位b
        oloaded = evt.loaded;//重新赋值已上传文件大小，用以下次计算
        //上传速度计算
        var speed = perload/pertime;//单位b/s
        var bspeed = speed;
        var units = 'b/s';//单位名称
        if(speed/102400>1){
            speed = speed/1024;
            units = 'k/s';
        }
        if(speed/102400>1){
            speed = speed/1024;
            units = 'M/s';
        }
        speed = speed.toFixed(1);
        //剩余时间
        var resttime = ((evt.total-evt.loaded)/bspeed).toFixed(1);
        time.innerHTML = '，速度：'+speed+units+'，剩余时间：'+resttime+'s';
        if(bspeed==0) time.innerHTML = '上传已取消';
    }
</script>
<script type="text/javascript">
	function aa(){
		var a=document.getElementById("uid").value;
		var a1=document.getElementById("title").value;
		var a2=document.getElementById("search_text").value;
		var a3=document.getElementById("search_text2").value;
		var a4=document.getElementById("date1").value;
		var a5=document.getElementById("date").value;
		var a6=document.getElementById("cscontent").value;
		var a7=document.getElementById("num").value;
		var url1="a";
		if(a!=''&& a1!=''&& a2!=''&& a3!=''&& a4!=''&& a5!='' && a6!=''&& a7!=''){
			$.ajax({
				url:"addjieban",
	  			type:'post',
	  			datatype:'json',
	  			data:{'uid':a,'title':a1,'ccid':a2,'cid':a3,'createtime':a4,'endtime':a5,'text':a6,'num':a7,'url':url1},
	  			success:function(data){
	  				if(data>0){
	  					layer.msg('成功');
	  					window.location.href="cs";
	  				}
	  			}
			});
		}else{
			layer.msg('是不是有没输入的字段？');
		}
	}
</script>
</html>